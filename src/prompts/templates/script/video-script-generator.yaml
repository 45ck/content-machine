# Video Script Generator
#
# Adapted from: MoneyPrinterTurbo
# Source: https://github.com/harry0703/MoneyPrinterTurbo
# License: MIT
# Original: app/services/llm.py generate_script()
# Adapted: 2026-01-10

id: script/video-script-generator
name: Video Script Generator
description: >
  Generates structured JSON scripts for short-form vertical video. Designed for
  TikTok, Reels, and Shorts with TTS-friendly pacing.
category: script
provider: any
outputFormat: json
version: "2.0.0"
tags:
  - script
  - narration
  - tiktok
  - shorts
  - video
estimatedTokens: 450
recommendedTemperature: 0.7

source:
  repository: MoneyPrinterTurbo
  url: https://github.com/harry0703/MoneyPrinterTurbo
  license: MIT
  originalPath: app/services/llm.py
  adaptedDate: "2026-01-10"
  modifications: >
    Converted to JSON output format. Added TTS pacing rules, hook dedupe guard,
    and archetype-specific guidance aligned with content-machine schema.

variables:
  - name: topic
    description: The main subject or topic of the video
    required: true
    type: string
    example: "5 JavaScript tips for beginners"
  - name: archetype
    description: Archetype id (string). Discover available ids via `cm archetypes list`.
    required: false
    type: string
    example: "listicle"
  - name: archetypeGuidance
    description: Optional archetype-specific guidance text (inject from an archetype data file).
    required: false
    type: string
  - name: targetDuration
    description: Target duration in seconds
    required: false
    type: number
    default: 45
    example: 45
  - name: targetWordCount
    description: Target total word count for spoken text
    required: false
    type: number
    default: 120
    example: 120
  - name: language
    description: Language for the script (e.g., "en", "es", "zh-CN")
    required: false
    type: string
    default: "en"
    example: "en"

systemPrompt: |
  You are an expert short-form video scriptwriter. You create scripts that are:
  - Engaging from the first word (strong hooks)
  - Concise and punchy (no filler words)
  - Written for spoken delivery (natural rhythm)
  - Optimized for 30-60 second videos
  - Returned as valid JSON

template: |
  # Role: Video Script Generator

  ## Goals:
  Generate a short-form video script about the topic.

  ## Constraints:
  1. Respond with JSON only. No markdown, no code fences, no commentary.
  2. Spoken text fields (hook, scenes[].text, cta) must be plain text: no emojis, no markdown, no hashtags.
  3. Hook must be ONE sentence and must NOT be repeated in scene 1.
  4. Scene 1 must continue after the hook with NEW information (no restating or paraphrasing the hook).
  5. Do not copy the hook sentence into any scene text.
  6. Hook must be a statement (no question mark).
  7. Always include hook and cta fields in the JSON.
  8. Each scene text must be at least 12 words.
  9. Write for spoken delivery at 120-180 WPM.
  10. Target length: ~{{targetWordCount}} words (~{{targetDuration}} seconds).
  11. Total spoken word count must be between ~0.8x and ~1.25x of targetWordCount.
  12. Use short sentences (<=15 words) and one idea per sentence.
  13. Each scene should be 1-2 sentences and ~18-28 words (minimum 12 words per scene).
  14. Use contractions and second person ("you", "you'll").
  15. Use punctuation for timing (commas = micro-pause, periods = full beat).
  16. Normalize text for speech: expand numbers, acronyms, URLs, emails, file paths, and units.
  17. Avoid openers like "In this video" or "Today we're going to".
  18. Double-check total word count before responding.
  19. visualDirection must describe concrete, filmable visuals (avoid abstract phrases like "technology" or "success").

  {{#if archetype}}
  ## Content Style: {{archetype}}
  {{/if}}
  {{#if archetypeGuidance}}
  {{archetypeGuidance}}
  {{/if}}

  # Input:
  - Topic: {{topic}}
  - Target duration: {{targetDuration}} seconds
  - Target word count: {{targetWordCount}}
  {{#if language}}- Language: {{language}}{{/if}}

  Respond with this JSON structure:
  {
    "scenes": [
      {"text": "Scene 1 spoken text", "visualDirection": "what to show visually", "mood": "emotional tone"},
      {"text": "Scene 2 spoken text", "visualDirection": "visual description", "mood": "tone"}
    ],
    "reasoning": "Explain your creative choices: hook, pacing, structure",
    "title": "Video title (optional)",
    "hook": "First sentence that grabs attention (optional)",
    "cta": "Call to action (optional)",
    "hashtags": ["#tag1", "#tag2"]
  }

examples:
  - input:
      topic: "Why Redis beats PostgreSQL for caching"
      archetype: "versus"
      targetDuration: 45
      targetWordCount: 120
    output: |
      {
        "scenes": [
          {
            "text": "Here is why Redis wins for caching: it keeps hot data in memory for instant reads. That speed makes your app feel snappy under load.",
            "visualDirection": "Split screen of Redis logo vs PostgreSQL logo",
            "mood": "bold"
          },
          {
            "text": "PostgreSQL stores data on disk and shines at complex queries and durability. Redis lives in RAM, so it answers reads in microseconds for hot data.",
            "visualDirection": "Disk drive vs glowing RAM sticks",
            "mood": "informative"
          },
          {
            "text": "Redis is simple to set up and scales fast for real-time leaderboards or live chat. PostgreSQL is better when you need joins, constraints, and strong consistency.",
            "visualDirection": "Speedometer jumping from slow to fast",
            "mood": "energetic"
          },
          {
            "text": "Use Redis for pure caching and bursty traffic spikes. Use PostgreSQL when your cache needs complex rules or a single system of record.",
            "visualDirection": "Checkmarks under each logo with labels",
            "mood": "decisive"
          }
        ],
        "reasoning": "Hook sets a clear stance, then contrasts disk vs memory to justify the recommendation.",
        "title": "Redis vs PostgreSQL for caching",
        "hook": "Stop using PostgreSQL for caching.",
        "cta": "Follow for more fast database tips.",
        "hashtags": ["#redis", "#postgres", "#databases"]
      }
